function getQueryParams(){let e={},t=window.location.search;return(t=t.substr(1)).split("&").forEach(function(t){let a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}),e}function extractJSON(e,t){var a=!1;for(const n in e)Array.isArray(e[n])||"object"==typeof e[n]?(console.log(t+n+" is array or object"),a=extractJSON(e[n],t+" > "+n+" > "),"error"===n&&(a=!0,console.log(a))):(console.log(t+n+": "+e[n]),"error"===n?(a=!0,$("#errorHeader").html(e[n]),console.log(a)):"message"===n&&(a=!0,$("#errorDetails").html(e[n]),console.log(a)));return a}function setQueryParams(e,t){window.history.pushState("Query Parameters","Addition of Queries","?url="+e+"&date="+t+"&lang="+document.documentElement.lang)}function getSpecifiedParam(e,t){for(let[a,n]of Object.entries(e))if(a===t)return n}$(document).on("wb-ready.wb",function(){$.i18n().load({en:"./assets/js/i18n/en.json",fr:"./assets/js/i18n/fr.json"}).done(function(){$("html").i18n(),$(".app-name").addClass("hidden"),$("#allspan").removeClass("hidden"),tippy("[data-template]",{content(e){const t=e.getAttribute("data-template");return $.i18n(t)},allowHTML:!0})});let e=getQueryParams();var t,a,n;t=getSpecifiedParam(e,"url"),a=getSpecifiedParam(e,"start"),n=getSpecifiedParam(e,"end"),date=getSpecifiedParam(e,"date"),a&&n&&(a=moment(a).format("MMMM D, YYYY"),n=moment(n).format("MMMM D, YYYY"),$(".dr-date-start").html(a),$(".dr-date-end").html(n)),t&&($("#urlval").val(t),$.isNumeric(date)&&$("#date-range").val(date).change(),mainQueue(t,a,n,0))});const kFormatter=e=>Math.abs(e)>999?Math.sign(e)*(Math.abs(e)/1e3).toFixed(1)+"k":Math.sign(e)*Math.abs(e),dynamicColors=()=>{return"rgba("+Math.floor(200*Math.random())+","+Math.floor(200*Math.random())+","+Math.floor(200*Math.random())+", 0.7)"},poolColors=e=>{var t=[];for(i=0;i<e;i++)t.push("rgba("+Math.floor(200*Math.random())+","+Math.floor(200*Math.random())+","+Math.floor(200*Math.random())+", 0.7)");return t};function isInt(e){return!isNaN(e)&&parseInt(Number(e))==e&&!isNaN(parseInt(e,10))}function generateTableHead(e,t,a){e.createCaption().innerHTML="<div class='wb-inv'>"+a+"</div";let n=e.createTHead().insertRow();for(let e of t){let t=document.createElement("th"),a=document.createTextNode(e);t.setAttribute("scope","col"),t.appendChild(a),n.appendChild(t)}}function generateTable(e,t){for(let n of t){let t=e.insertRow();for(a in n){var a=n[a];let e=t.insertCell();isInt(a)&&(a=a.toLocaleString(document.documentElement.lang+"-CA")),e.insertAdjacentHTML("beforeend",a)}}}function getPDF2(){var e=[],t=new jsPDF;$.each(["#canvas-container"],function(a,n){console.log(n);var r=$.Deferred();generateCanvas(n,t,r),e.push(r.promise())}),$.when.apply($,e).then(function(){t.save("HTML-Document.pdf")})}function generateCanvas(e,t,a){var n=$(e).width(),r=$(e).height(),s=n+40,l=1.5*s+40,o=n,i=r,d=Math.ceil(r/l)-1;html2canvas($(e)[0],{allowTaint:!0,scrollX:0,scrollY:-window.scrollY}).then(function(e){e.getContext("2d"),console.log(e.height+"  "+e.width);var t=e.toDataURL("image/jpeg",1),n=new jsPDF("p","pt",[s,l]);n.addImage(t,"JPG",20,20,o,i);for(var r=1;r<=d;r++)n.addPage(s,l),n.addImage(t,"JPG",20,-l*r+20*(2*r+1),o,i);a.resolve()})}function genPDF(){var e=new jsPDF;$.each(["#canvas-container"],function(t,a){console.log(a);var n=$.Deferred();generateCanvas(a,e,n)}),$.when.apply($,[]).then(function(){e.save("test.pdf")})}function generateCanvas2(e,t,a){html2canvas($(e)[0],{onrendered:function(e){var n=e.toDataURL();t.addImage(n,"PNG"),t.addPage(),a.resolve()}})}function getPDF(){var e=$("main").width(),t=$("main").height(),a=e+40,n=1.5*a+40,r=e,s=t,l=Math.ceil(t/n)-1;html2canvas($("main")[0],{allowTaint:!0,scrollX:0,scrollY:-window.scrollY}).then(function(e){e.getContext("2d"),console.log(e.height+"  "+e.width);var t=e.toDataURL("image/jpeg",1),o=new jsPDF("p","pt",[a,n]);o.addImage(t,"JPG",20,20,r,s);for(var i=1;i<=l;i++)o.addPage(a,n),o.addImage(t,"JPG",20,-n*i+20*(2*i+1),r,s);o.save("HTML-Document.pdf")})}function printToPDF(){console.log("converting...");var e=new jsPDF("p","pt","letter");e.addHTML($("#canvas-container")[0],{pagesplit:!0,background:"#fff"},function(){e.save("Test.pdf")})}const jsonPieGenerate=e=>{$("#chart").remove(),$("#chart-canvas").append("<canvas id='chart'></canvas>"),val=e,cnt=val.length,bgColor=["#56B4E9","#009E73","#0072B2","#000000"];var t=[{data:val,backgroundColor:bgColor}],a={responsive:!0,maintainAspectRatio:!1,plugins:{beforeInit:(e,t)=>{Chart.Legend.afterFit=function(){this.height=this.height+50}},datalabels:{formatter:(e,t)=>{let a=0;t.chart.data.datasets[0].data.map(e=>{a+=e});let n=parseFloat((100*e/a).toFixed(1)).toLocaleString(document.documentElement.lang+"-CA");if("fr"==document.documentElement.lang)var r=" %";else r="%";return n+r},backgroundColor:function(e){return e.dataset.backgroundColor},borderRadius:4,color:"white",font:{weight:"bold",size:18}}},tooltips:"false",legend:{position:"bottom",minSize:{height:500},labels:{fontSize:18}},layout:{padding:{top:25}}},n=document.getElementById("chart").getContext("2d"),r=new Chart(n,{type:"pie",data:{datasets:t,labels:[$.i18n("Desktop"),$.i18n("MobilePhone"),$.i18n("Tablet"),$.i18n("Other")]},options:a});sum=val.reduce(function(e,t){return e+t},0);let s=[];$.each(val,function(e,t){if(val=t,lab=r.data.labels[e],per=parseFloat((100*val/sum).toFixed(2)).toLocaleString(document.documentElement.lang+"-CA"),"fr"==document.documentElement.lang)var a="&nbsp;%";else a="%";per+=a,val=t.toLocaleString(document.documentElement.lang+"-CA");var n={};n[$.i18n("DeviceType")]=lab,n[$.i18n("Visits")]=val,n[$.i18n("Percent")]=per,s.push(n)});let l=document.querySelector("table#tbl-pltfrm"),o=Object.keys(s[0]);l.innerHTML="",generateTable(l,s),generateTableHead(l,o,$.i18n("Percentage (%) of visits by device used")),$("#chart-pltfrms").show(),$("#chrtp").hide()},RANGE=(e,t)=>Array.from(function*(e,t){for(;e<=t;)yield e++}(e,t));var numberWithCommas=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};const jsonTrendGenerate=(e,t,a)=>{var n=e.rows;if(null!=n){$("#trends").remove(),$("#trends-canvas").append("<canvas id='trends'></canvas>");for(var r=Object.keys(n),s=[],l=0;l<r.length;l++){var o=r[l];s.push(n[o].data)}$cnt=s.length,val=s.slice(0,$cnt/2),lval=s.slice($cnt/2,$cnt),1==t?(val=val.slice(-7),lval=lval.slice(-7)):2==t&&(val=val.slice(-1),lval=lval.slice(-1)),console.log(val),$cnt=val.length;for(var i=[],d=[],c=moment(a[0]);c.isBefore(a[1]);c.add(1,"days"))i.push(c.locale(document.documentElement.lang).format("MMM-DD")),d.push(c.locale(document.documentElement.lang).format("MMMM DD"));$rng=RANGE(1,$cnt),console.log($rng);const e="day".replace(/^\w/,e=>e.toUpperCase());var p={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{display:!1}},scales:{yAxes:[{scaleLabel:{display:!0,labelString:$.i18n("Numberofvisits"),fontSize:18},ticks:{beginAtZero:!0,callback:function(e,t,a){return Intl.NumberFormat().format(e/1e3)},fontSize:18}}],xAxes:[{scaleLabel:{display:!0,labelString:$.i18n(e)+$.i18n("Dayofselecteddaterange"),fontSize:18},gridLines:{display:!1},ticks:{fontSize:18}}]},tooltips:"false",hover:{mode:"nearest",intersect:!0},legend:{position:"bottom",labels:{usePointStyle:!0,fontSize:18}},layout:{padding:{top:25}}},m=document.getElementById("trends").getContext("2d"),u=new Chart(m,{type:"line",data:{labels:i,datasets:[{label:$.i18n("CurrentYear"),data:val,borderColor:"#56B4E9",backgroundColor:"#56B4E9",fill:!1},{label:$.i18n("PreviousYear"),data:lval,borderColor:"#009E73",backgroundColor:"#009E73",fill:!1}]},options:p});let h=[];$.each(val,function(t,a){vals=val[t],lvals=lval[t],lab=u.data.labels[t],diff=((vals-lvals)/lvals*100).toFixed(1),"Infinity"==diff?diff=$.i18n("NotAvailable"):"fr"==document.documentElement.lang?diff=parseFloat(diff).toLocaleString(document.documentElement.lang+"-CA")+"&nbsp;%":diff=parseFloat(diff)+"%",vals=val[t].toLocaleString(document.documentElement.lang+"-CA"),lvals=lval[t].toLocaleString(document.documentElement.lang+"-CA");var n={};n[$.i18n(e)]=d[t],n[$.i18n("CurrentYear")]=vals,n[$.i18n("PreviousYear")]=lvals,n[$.i18n("Difference")]=diff,h.push(n)});let g=document.querySelector("table#tbl-trnds"),v=Object.keys(h[0]);g.innerHTML="",generateTable(g,h),generateTableHead(g,v,$.i18n("Visitstrendbycurrentyearandpreviousyear")),$("#chart-trnds").show(),$("#chrtt").hide()}else $("#chart-trnds").hide(),$("#chrtt").show()},jsonFile=e=>{},getPageTitle=e=>Object.keys(e).map((t,a)=>{var n=e[t].value;if(-1!==(n=-1!==n.indexOf("https://")?n:"https://"+n).indexOf("canada.ca")){let e=new Request(n,{method:"GET"});return fetch(e).then(e=>e.text()).then(e=>$(e).find("h1:first").text()).catch(console.error.bind(console))}}),getPageH1=e=>{console.log("1: "+e),e=-1!==e.indexOf("https://")?e:"https://"+e;let t=new Request(e,{method:"GET"});return fetch(t).then(e=>e.text()).then(e=>$(e).find("h1:first").text()).catch(console.error.bind(console))},getPage=e=>{if(-1!==(e=-1!==e.indexOf("https://")?e:"https://"+e).indexOf("canada.ca")){let t=new Request(e,{method:"GET"});return fetch(t).then(e=>e.text()).then(e=>{return{html:e}}).catch(console.error.bind(console))}},jsonPrevious=(e,t)=>{var a=e.rows[0],n="#ppt";title=$.i18n("Whereuserscamefrom");var r=$(n);if(null!=a){var s=e.rows;r.html("");var l=[];if($.each(s,function(e,a){url=a.value,term=url,clicks=a.data[t],f="blank page url"==url?$.i18n("Directtraffic/Bookmark"):"<a href='"+url+"'>"+term+"</a>";var n={};n[$.i18n("PreviouspageURL")]=f,n[$.i18n("Visits")]=clicks,l.push(n)}),0!=l.length){$(n).html(getTable(5,"false"));let e=document.querySelector("#ppt table"),t=Object.keys(l[0]);generateTable(e,l),generateTableHead(e,t,title),$("#ppt table").trigger("wb-init.wb-tables")}else r.html($.i18n("Nodata"))}else r.html($.i18n("Nodata"))},jsonForward=e=>{},jsonSnum=(e,t)=>{var a=e.rows[0],n=$("#snum"),r=parseInt($("#numDays").html());if(n.html(""),null!=a)return snum=a.data[t],snumDays=parseInt(snum/r).toLocaleString(document.documentElement.lang+"-CA"),snum=parseInt(snum).toLocaleString(document.documentElement.lang+"-CA"),2==t?n.prepend("<span class='h1'>"+snum+"</span> <strong>"+$.i18n("total")+"</strong>"):n.prepend("<span class='h1'>"+snumDays+"</span> <strong>"+$.i18n("averageperday")+"</strong></br><span class='small'>"+snum+" "+$.i18n("total")+"</span>"),itemid=a.itemId,itemid;n.html("No data")},jsonSearches=(e,t)=>{if(null!=e.rows[0]){var a=e.rows,n=[];$.each(a,function(e,a){search=a.value,searchurl="https://www.canada.ca/en/revenue-agency/search.html?cdn=canada&st=s&num=10&langs=en&st1rt=1&s5bm3ts21rch=x&q="+search+"&_charset_=UTF-8&wb-srch-sub=",searchv=a.data[t],"0"!=searchv&&n.push({Term:search,url:searchurl,Clicks:searchv})}),0!=n.length&&(n.sort((e,t)=>t.Clicks-e.Clicks),$.each(n,function(e,t){$search="#search"+e,$searchhtml=$($search),$searchhtml.html(""),$($search).append("<a href='"+t.url+"'>"+t.Term+"</a>").append(" ("+t.Clicks.toLocaleString(document.documentElement.lang+"-CA")+")")}))}else{a=new Array(4);$search=$("#search0"),$search.html($.i18n("Nodata")),$.each(a,function(e,t){0!=e&&($search=$("#search"+e),$search.html(""))})}},jsonDownload=e=>{var t=e.rows[0];if($dwnld=$("#dwnld"),null!=t){var a=e.rows;$dwnld.html(""),$dwnld.append($("<ul class='colcount-sm-2'>")),$dwnld=$("#dwnld ul");var n=[],r=[];$.each(a,function(e,t){var a=t.value,s=t.data[0];a.includes(".pdf")?(a.includes("-lp")&&(type="Large Print"),a.includes("-fill-")?type="Fillable":type="Flat"):a.includes(".txt")?type="E-Text":type=a.split("/").pop().split(".").pop().toUpperCase();var l=a.split("/").pop();n.push(a),r.push({term:a,clicks:s,type:type,filename:l})}),$url="https://www.canada.ca/en/revenue-agency/services/forms-publications/td1-personal-tax-credits-returns/td1-forms-pay-received-on-january-1-later/td1.html";var s=$url.split("/").pop().split(".").shift(),l=n.findReg("^https://www.canada.ca/.*?"+s+"-(fill-)*([0-9]{1,2})"),o=$("#np");o.html(""),o.append($("<ul class='colcount-sm-2>")),o=$("#np ul"),$.each(r,function(e,t){$.each(l,function(e,a){t.term==a&&o.append($("<li>").append(t.filename+" ("+t.clicks.toLocaleString(document.documentElement.lang+"-CA")+") [<em>"+t.type+"</em>]"))})})}else $dwnld.html($.i18n("Nodata"))},jsonOutbound=(e,t)=>{var a=e.rows[0];if($outbnd=$("#outbnd"),null!=a){var n=e.rows;$outbnd.html(""),$outbnd.append($("<ul class='colcount-sm-2'>")),$outbnd=$("#outbnd ul"),Promise.all([getPage(t)]).then(e=>{e[0].html;$.each(n,function(e,t){text=t.value,outbnd=t.data[0],$outbnd.append($("<li>").append(text+" ("+outbnd.toLocaleString(document.documentElement.lang+"-CA")+")"))})})}else $outbnd.html($.i18n("Nodata"))},jsonRT=(e,t)=>{val="#reft",title=$.i18n("Referringtypes");var a=$(val),n=e;a.html("");var r=[];if($.each(n,function(e,t){term=t[0],clicks=t[1];var a={};a[$.i18n("Type")]=$.i18n(term.replace(/\s/g,"")),a[$.i18n("Visits")]=clicks,r.push(a)}),0!=r.length){$(val).html(getTable(5,"false","false","false"));let e=document.querySelector(val+" table"),t=Object.keys(r[0]);generateTable(e,r),generateTableHead(e,t,title),$(val+" table").trigger("wb-init.wb-tables")}else a.html($.i18n("Nodata"))},jsonTable=(e,t,a,n,r)=>{a=$.i18n(a);var s=$(t),l=e;s.html("");var o=[];if($.each(l,function(e,t){for(var a={},r=0;r<n.length;r++){if(term=t[r],!isInt(term)&&-1!==term.indexOf("||")){var s=term.split("||");s.length>1&&("en"==document.documentElement.lang?term=s[0]:term=s[1])}a[$.i18n(n[r])]=term}o.push(a)}),0!=o.length){$(t).html(getTable(10,"false","false","false"));let e=document.querySelector(t+" table"),n=Object.keys(o[0]);generateTable(e,o),generateTableHead(e,n,a),$(t+" table").trigger("wb-init.wb-tables")}else s.html($.i18n("Nodata"))};function getTable(e=null,t=null,a=null,n=null,r=null,s=null,l=null,o=null){return o||(o="wb-tables table table-responsive"),e||(e=5),t||(t=!1),a||(a=!0),n||(n=!0),r||(r=[1,"&quot;desc&quot;"]),s||(s=[5,10,25,-1]),l||(l=[5,10,25,"&quot;All&quot;"]),'<table class="'+o+"\" data-wb-tables='{ &quot;pageLength&quot; : "+e+", &quot;order&quot; : [ "+r+" ] , &quot;lengthMenu&quot; : [ [ "+s+" ], [ "+l+" ] ] ,&quot;searching&quot; : "+t+",&quot;info&quot; : "+a+",&quot;lengthChange&quot; : "+n+"}'></table>"}const jsonSearch=(e,t,a,n)=>{var r=e.rows[0],s=$(t);if(null!=r){var l=e.rows;s.html("");var o=[];if($.each(l,function(e,t){if(term=t.value,clicks=t.data[n],"(Low Traffic)"!=term&&"Unspecified"!=term&&0!=clicks){var a={};a[$.i18n("Term")]=term,a[$.i18n("Clicks")]=clicks,o.push(a)}}),0!=o.length){$(t).html(getTable(10));let e=document.querySelector(t+" table"),n=Object.keys(o[0]);generateTable(e,o),generateTableHead(e,n,a)}else s.html($.i18n("Nodata"))}else s.html($.i18n("Nodata"))},jsonSearchesPhrases=(e,t)=>{var a=$.i18n("Searches from page");jsonSearch(e,"#srchP",a,t),$("#srchP table").trigger("wb-init.wb-tables")},jsonSearchesAll=(e,t)=>{var a=$.i18n("Searches to page");jsonSearch(e,"#srchA",a,t),$("#srchA table").trigger("wb-init.wb-tables")},jsonSearchesInstitution=e=>{var t=$.i18n("Contextualsearchestopage");jsonSearch(e,"#srchI",t),$("#srchI").trigger("wb-init.wb-tables")},jsonSearchesGlobal=e=>{var t=$.i18n("Globalsearchestopage");jsonSearch(e,"#srchG",t),$("#srchG").trigger("wb-init.wb-tables")};function sortByCol(e){return e.sort((e,t)=>t.Clicks-e.Clicks)}const jsonAM=(e,t)=>{var a=e.rows[0],n=$("#np");if(null!=a){var r=e.rows;n.html("");var s=[];if($.each(r,function(e,a){if(term=a.value,clicks=a.data[t],"(Low Traffic)"!=term&&"Unspecified"!=term){var n={};n[$.i18n("LinkText")]=term,n[$.i18n("Clicks")]=clicks,s.push(n)}}),0!=s.length){n.html(getTable(10));let e=document.querySelector("#np table"),t=Object.keys(s[0]);generateTable(e,s),generateTableHead(e,t,$.i18n("OutboundClicksonPage")),$("#np table").trigger("wb-init.wb-tables")}else n.html($.i18n("Nodata"))}else n.html($.i18n("Nodata"))},jsonFWYLF=(e,t)=>{var a=e.rows[0],n=$("#fwylfReason"),r="#fwylfReason",s=$.i18n("NoClicks");if(null!=a){var l=e.rows;n.html("");var o=[];if($.each(l,function(e,a){term=a.value,clicks=a.data[t];var n={},r=term.split("-");r.length>1?"en"==document.documentElement.lang?term=r[0]:term=r[1]:term=$.i18n(r[0]),n[$.i18n("Reason")]=term,n[$.i18n("Submits")]=clicks,o.push(n)}),0!=o.length){n.html(getTable(10,"false","false","false"));let e=document.querySelector(r+" table"),t=Object.keys(o[0]);generateTable(e,o),generateTableHead(e,t,s),$(r+" table").trigger("wb-init.wb-tables")}else n.html($.i18n("Nodata"))}},jsonMetrics=(e,t)=>{var a=e.summaryData.filteredTotals,n=$("#uv"),r=($("#uniquevisit"),$("#visit")),s=$("#pagev"),l=$("#avgtime"),o=parseInt($("#numDays").html()),i=parseFloat($("#numWeeks").html()),d=0+parseInt(t),c=6+parseInt(t),p=9+parseInt(t),m=24+parseInt(t),u=30+parseInt(t),h=12+parseInt(t),g=15+parseInt(t),v=18+parseInt(t),f=21+parseInt(t),b=45+parseInt(t),y=48+parseInt(t),C=51+parseInt(t),S=54+parseInt(t),w=57+parseInt(t),I=60+parseInt(t),k=63+parseInt(t),M=66+parseInt(t),A=69+parseInt(t),T=72+parseInt(t),D=75+parseInt(t),L=78+parseInt(t),j=81+parseInt(t),P=84+parseInt(t),N=87+parseInt(t),E=90+parseInt(t),Y=93+parseInt(t),x=96+parseInt(t),O=111+parseInt(t),G=114+parseInt(t),F=117+parseInt(t),q=120+parseInt(t),R=123+parseInt(t),B=126+parseInt(t),H=129+parseInt(t),Q=132+parseInt(t),U=135+parseInt(t),W=138+parseInt(t),z=141+parseInt(t),J=144+parseInt(t),K=147+parseInt(t),V=150+parseInt(t),_=99+parseInt(t),Z=102+parseInt(t),X=105+parseInt(t),ee=108+parseInt(t);if(n.html(""),r.html(""),s.html(""),l.html(""),null!=a){uv=parseInt(a[p]),uvDays=parseInt(uv/o).toLocaleString(document.documentElement.lang+"-CA"),uv=parseInt(uv).toLocaleString(document.documentElement.lang+"-CA"),visit=parseInt(a[c]),vDays=parseInt(visit/o).toLocaleString(document.documentElement.lang+"-CA"),visit=parseInt(visit).toLocaleString(document.documentElement.lang+"-CA"),pv=parseInt(a[d]),pvDays=parseInt(pv/o).toLocaleString(document.documentElement.lang+"-CA"),pv=parseInt(pv).toLocaleString(document.documentElement.lang+"-CA"),atMin=moment.utc(1e3*a[m]).format("m"),atSec=moment.utc(1e3*a[m]).format("ss"),l.prepend("<span class='h2'>"+atMin+" min "+atSec+" sec</span>"),2===t?(n.prepend("<span class='h2'>"+uv+"</span>"),r.prepend("<span class='h2'>"+visit+"</span>"),s.prepend("<span class='h2'>"+pv+"</span>"),l.closest("section").height("98px")):(n.prepend("<span class='h2'>"+uv+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+uvDays+"</div>"),r.prepend("<span class='h2'>"+visit+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+vDays+"</div>"),s.prepend("<span class='h2'>"+pv+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+pvDays+"</div>"),l.closest("section").height("138px")),NaN==parseInt(a[S])||0==parseInt(a[b])?($("#rapCont").html('<p id="rap"></p>'),rap=parseInt(a[u]),2==t&&(i=1),rapWeeks=parseInt(rap/i).toLocaleString(document.documentElement.lang+"-CA"),rap=parseInt(rap).toLocaleString(document.documentElement.lang+"-CA"),2==t?$("#rap").prepend("<span class='h1'>"+rap+"</span> <strong>"+$.i18n("total")+"</strong>"):$("#rap").prepend("<span class='h1'>"+rapWeeks+"</span> <strong>"+$.i18n("averageperweek")+"</strong></br><span class='small'>"+rap+" "+$.i18n("total")+"</span>"),$("#fwylfCont").html('<div id="fwylfTable"></div><div id="fwylfReason"></div>'),$("#rap-container").show(),$("#fwylf-container").hide()):($("#fwylfCont").html('<div id="fwylfTable"></div><div id="fwylfReason"></div>'),$("#fwylfTable").html('<table class="table table-striped"><thead><th scope="col">'+$.i18n("Yes")+'</th><th scope="col">'+$.i18n("No")+'</th></thead><tr><td id="fwylfYes"></td><td id="fwylfNo"></td></tr></table>'),$("#fwylfYes").html(a[C]),$("#fwylfNo").html(a[y]),$("#rapCont").html(""),$("#rap-container").hide(),$("#fwylf-container").show()),desktop=parseInt(a[h]),mobile=parseInt(a[g]),tablet=parseInt(a[v]),other=parseInt(a[f]);var te=[desktop,mobile,tablet,other];jsonPieGenerate(te),searchEngine=parseInt(a[_]),otherWebsites=parseInt(a[Z]),socialNetworks=parseInt(a[X]),typedBookmarked=parseInt(a[ee]);let e=[["Search Engines",searchEngine],["Other Web Sites",otherWebsites],["Social Networks",socialNetworks],["Typed / Bookmarked",typedBookmarked]];jsonRT(e),rapVal="#rapReason",rapTitle=$.i18n("reportaproblem"),rapHeaders=["Response","Clicks"],rapICantFind=parseInt(a[O]),rapLoginError=parseInt(a[G]),rapOtherIssue=parseInt(a[F]),rapSIN=parseInt(a[q]),rapInfoIsMissing=parseInt(a[R]),rapSecureKey=parseInt(a[B]),rapOtherLoginNotList=parseInt(a[H]),rapGCKey=parseInt(a[Q]),rapInfoOutdated=parseInt(a[U]),rapSpellingMistake=parseInt(a[W]),rapPAC=parseInt(a[z]),rapLinkButtonNotWork=parseInt(a[J]),rap404=parseInt(a[K]),rapBlank=parseInt(a[V]);let ae=[["I can't find what I'm looking for||Je n'arrive pas à trouver ce que je cherche",rapICantFind],["Login error when trying to access an account (e.g. My Service Canada Account)||Message d'erreur à l'ouverture de la session lorsque je tente d'accéder à un compte (ex. Mon dossier Service Canada)",rapLoginError],["Other issue not in this list||Autre problème qui ne figure pas sur cette liste",rapOtherIssue],["Social Insurance Number (SIN) validation problems||Problème lié à la validation du numéro d'assurance sociale (NAS)",rapSIN],["Information is missing||Les renseignements sont incomplets",rapInfoIsMissing],["SecureKey Concierge (Banking Credential) access||Accès SecureKey Service de Concierge (justificatifs d'identité bancaires)",rapSecureKey],["Other login error not in this list||Autre erreur lors de l'ouverture de session qui ne figure pas sur cette liste",rapOtherLoginNotList],["GC Key access||Accès CléGC",rapGCKey],["Information is outdated or wrong||L'information n'est plus à jour ou est erronée",rapInfoOutdated],["It has a spelling mistake||Il y a une erreur d'orthographe ou de grammaire",rapSpellingMistake],["Personal Access Code (PAC) problems or EI Access Code (AC) problems||Problème avec le Code d'accès personnel (CAP) ou avec le Code d'accès (CA) de l'assurance emploi",rapPAC],["A link, button or video is not working||Un lien, un bouton ou une vidéo ne fonctionne pas",rapLinkButtonNotWork],["Report a problem submissions that are 404 Pages||Signaler un problème dans les soumissions de 404 pages",rap404],["Report a problem submissions with no boxes checked||Signaler une soumission de problème sans case cochée",rapBlank]];jsonTable(ae,rapVal,rapTitle,rapHeaders),provVal="#provChart",provTitle=$.i18n("provTerr"),provHeaders=[$.i18n("provTerrHeader"),"Visits"],provAlberta=parseInt(a[w]),provBC=parseInt(a[I]),provMB=parseInt(a[k]),provNB=parseInt(a[M]),provNFL=parseInt(a[A]),provNWT=parseInt(a[T]),provNS=parseInt(a[D]),provNV=parseInt(a[L]),provON=parseInt(a[j]),provOutCAN=parseInt(a[P]),provPEI=parseInt(a[N]),provQB=parseInt(a[E]),provSK=parseInt(a[Y]),provYK=parseInt(a[x]);let ne=[["Alberta||L'Alberta",provAlberta],["British Columbia||La Colombie-Britannique",provBC],["Manitoba||Le Manitoba",provMB],["New Brunswick||Le Nouveau-Brunswick",provNB],["Newfoundland and Labrador||La Terre-Neuve-et-Labrador",provNFL],["Northwest Territories||Les Territoires du Nord-Ouest",provNWT],["Nova Scotia||La Nouvelle-Écosse",provNS],["Nunavut||Le Nunavut",provNV],["Ontario||L'Ontario",provON],["Outside Canada||À l'extérieur du Canada",provOutCAN],["Prince Edward Island||Île-du-Prince-Édouard",provPEI],["Quebec||Le Québec",provQB],["Saskatchewan||La Saskatchewan",provSK],["Yukon (Territory)||Le Yukon (Territoire)",provYK]];jsonTable(ne,provVal,provTitle,provHeaders)}else n.html("0"),$rap.html("0")};function nFormatter(e,t){var a,n=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(a=n.length-1;a>0&&!(e>=n[a].value);a--);return(e=parseFloat((e/n[a].value).toFixed(t)).toLocaleString(document.documentElement.lang+"-CA")).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n[a].symbol}const jsonGSCTotal=(e,t)=>{var a=e.rows,n=$("#gsc-clicks"),r=$("#gsc-imp"),s=$("#gsc-ctr"),l=$("#gsc-pos"),o=parseInt($("#numDaysgsc").html());if(n.html(""),r.html(""),s.html(""),l.html(""),null!=a)for(let e of a)clicks=parseInt(e.clicks),fClicks=clicks.toLocaleString(document.documentElement.lang+"-CA"),vClicks=parseInt(clicks/o).toLocaleString(document.documentElement.lang+"-CA"),imp=parseInt(e.impressions),fImp=imp.toLocaleString(document.documentElement.lang+"-CA"),vImp=parseInt(imp/o).toLocaleString(document.documentElement.lang+"-CA"),2===t?(n.prepend("<span class='h2'>"+fClicks+"</span>"),r.prepend("<span class='h2'>"+fImp+"</span>")):(n.prepend("<span class='h2'>"+fClicks+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+vClicks+"</div>"),r.prepend("<span class='h2'>"+fImp+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+vImp+"</div>"));else n.html("0"),r.html("0"),s.html("0"),l.html("0")},jsonGSCGenerate=(e,t)=>{var a=e.rows;if(null!=a){$("#gsc").remove(),$("#gsc-canvas").append("<canvas id='gsc'></canvas>"),$cnt=a.length;var n=[],r=[],s=[],l=[];$.each(a,function(e,t){if(val=t,n.push(parseInt(val.clicks)),r.push(parseInt(val.impressions)),"fr"==document.documentElement.lang);else;var a=moment(val.keys[0]).locale(document.documentElement.lang).format("MMM-DD"),o=moment(val.keys[0]).locale(document.documentElement.lang).format("MMMM DD, YYYY");s.push(a);var i={};i[$.i18n("Day")]=o,i[$.i18n("Clicks")]=val.clicks.toLocaleString(document.documentElement.lang+"-CA"),i[$.i18n("Impressions")]=val.impressions.toLocaleString(document.documentElement.lang+"-CA"),l.push(i)});var o={plugins:{datalabels:{display:!1}},responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{id:"y-axis-0",type:"linear",display:!0,position:"left",ticks:{beginAtZero:!0,callback:function(e,t,a){return Intl.NumberFormat().format(e/1e3)},fontSize:18},scaleLabel:{display:!0,labelString:$.i18n("GSCClicks"),fontSize:18}},{id:"y-axis-1",type:"linear",display:!0,position:"right",ticks:{beginAtZero:!0,callback:function(e,t,a){return Intl.NumberFormat().format(e/1e3)},fontSize:18},scaleLabel:{display:!0,labelString:$.i18n("GSCImpressions"),fontSize:18}}],xAxes:[{scaleLabel:{display:!0,labelString:$.i18n("Dayofselecteddaterange2"),fontSize:18},ticks:{fontSize:18}}]},tooltips:!1,hover:{mode:"nearest",intersect:!0},legend:{position:"top",labels:{usePointStyle:!0}},layout:{padding:{top:25}}};Chart.defaults.global.showTooltips=!1;var i=document.getElementById("gsc").getContext("2d");new Chart(i,{type:"line",data:{labels:s,datasets:[{yAxisID:"y-axis-0",label:$.i18n("Clicks"),data:n,fill:!1,borderColor:"#4285f4"},{yAxisID:"y-axis-1",label:$.i18n("Impressions"),data:r,fill:!1,borderColor:"#5e35b1"}]},options:o});let e=document.querySelector("table#tbl-gsc"),t=Object.keys(l[0]);e.innerHTML="",generateTable(e,l),generateTableHead(e,t,$.i18n("Visitstrendbycurrentyearandpreviousyear")),$("#chart-gsc").show(),$("#chrtgsc").hide()}else $("#chart-gsc").hide(),$("#chrtgsc").show()},jsonGSC=(e,t,a,n)=>{var r=e.rows,s=$(t);if(console.log(r),null!=r){var l=e.rows;s.html("");var o=[];if($.each(l,function(e,t){if(term=t.keys[n],clicks=t.clicks,imp=t.impressions,ctr=parseFloat(100*t.ctr).toFixed(1),pos=t.position.toFixed(1),"fr"==document.documentElement.lang)var a="&nbsp;%";else a="%";var r={};r[$.i18n("Term")]=term,r[$.i18n("Clicks")]=clicks,r[$.i18n("Impressions")]=imp,r[$.i18n("CTR")]=ctr+a,r[$.i18n("Position")]=pos,o.push(r)}),0!=o.length){$(t).html(getTable(10));let e=document.querySelector(t+" table"),n=Object.keys(o[0]);generateTable(e,o),generateTableHead(e,n,a)}else s.html($.i18n("Nodata"))}else s.html($.i18n("Nodata"))},jsonGSCQryAll=(e,t)=>{var a=$.i18n("All - Queries"),n="#gscQryAll";jsonGSC(e,n,a,0),$(n+" table").trigger("wb-init.wb-tables")},jsonGSCQryMobile=(e,t)=>{var a=$.i18n("Mobile - Queries"),n="#gscQryMob";jsonGSC(e,n,a,0),$(n+" table").trigger("wb-init.wb-tables")},jsonGSCQryDesktop=(e,t)=>{var a=$.i18n("Desktop - Queries"),n="#gscQryDesk";jsonGSC(e,n,a,0),$(n+" table").trigger("wb-init.wb-tables")},jsonGSCQryTablet=(e,t)=>{var a=$.i18n("Desktop - Queries"),n="#gscQryTab";jsonGSC(e,n,a,0),$(n+" table").trigger("wb-init.wb-tables")},jsonGSCCountry=(e,t)=>{"en"==document.documentElement.lang?lang=0:lang=1;var a=$.i18n("Countries"),n="#gscCountry";jsonGSC(e,n,a,lang),$(n+" table").trigger("wb-init.wb-tables")};function search_country(e){var t=JSON.parse("../assets/js/json/country-en.json");if(condole.log(t),void 0!==e.id||void 0!==e.alpha2||void 0!==e.alpha3)return t.filter(function(t){return void 0!==e.id&&parseInt(t.id,10)===parseInt(e.id,10)||void 0!==e.alpha2&&t.alpha2===e.alpha2.toLowerCase()||void 0!==e.alpha3&&t.alpha3===e.alpha3.toLowerCase()}).pop()}function fetchWithTimeout(e,t,a,n){const r=new Promise(e=>{setTimeout(e,a,{timeout:!0})});return Promise.race([fetch(e,t),r]).then(e=>(e.timeout&&n(),e))}const apiCall=(e,t,a,n,r,s,l)=>a.map(a=>{url="fle"==a?"php/file.php":"php/process.php",post={dates:e,url:t,type:a,oUrl:n,field:s,lang:l};let o=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(o).then(e=>e.json()).then(t=>{if(console.log(a),console.log(t),t.error)return Promise.resolve(t);switch(a){case"fle":return;case"snmAll":return jsonSnum(t,r);case"srchLeftAll":return jsonSearchesPhrases(t,r);case"trnd":return jsonTrendGenerate(t,r,e);case"prvs":return jsonPrevious(t,r);case"frwrd":return;case"srchAll":return jsonSearchesAll(t,r);case"activityMap":return jsonAM(t,r);case"metrics-new":return jsonMetrics(t,r);case"fwylf":return jsonFWYLF(t,r);case"cntry":return jsonGSCCountry(t);case"qryAll":return jsonGSCQryAll(t);case"qryMobile":return jsonGSCQryMobile(t);case"qryDesktop":return jsonGSCQryDesktop(t);case"qryTablet":return jsonGSCQryTablet(t);case"totals":return jsonGSCTotal(t,r);case"totalDate":return jsonGSCGenerate(t)}}).catch(function(e){console.log(a),console.log(e.message),console.log(e.stack)})}),apiCall2=(e,t,a,n,r)=>a.map(a=>{url="php/process-new.php",post={dates:e,url:t,oUrl:n,lang:r};let s=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(s).then(e=>e.json()).then(e=>($("#urlStatic").html("https://"+e.url),e)).catch(function(e){console.log(a),console.log(e.message),console.log(e.stack)})}),apiCallGSC2=(e,t,a,n,r,s)=>a.map(a=>{url="php/process-gsc.php",post={dates:e,url:t,oUrl:n,day:r,lang:s};let l=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(l).then(e=>e.json()).then(e=>{var t=moment(e.start),a=moment(e.end),n=a.diff(t,"days")+1;$("#urlStatic").html(e.url),$("#fromGSC").html(e.start),$("#toGSC").html(e.end),t.locale(document.documentElement.lang),a.locale(document.documentElement.lang);var r=t.format("dddd MMMM DD, YYYY"),s=a.format("dddd MMMM DD, YYYY");return $dd=$("#date-range").find(":selected").data("index"),$("#fromdaterangegsc").html("<strong>"+r+"</strong>"),$("#todaterangegsc").html("<strong>"+s+"</strong>"),$("#numDaysgsc").html(n),e}).catch(function(e){console.log(a),console.log(e.message),console.log(e.stack)})}),apiCallBP=(e,t,a,n)=>a.map(a=>{url="php/process-bp.php",post={dates:e,url:t,oUrl:n,lang:document.documentElement.lang};let r=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(r).then(e=>e.json()).then(e=>{-1==e.html.indexOf("No data")?($("#bp-content").html(e.html),$("#bp-content").append("<p> For more options and date ranges, please visit <a href='https://feedback-by-page.tbs.alpha.canada.ca/bypage?page="+n+"' target='_blank'>https://feedback-by-page.tbs.alpha.canada.ca/bypage?page="+n+"</a></p>"),$("#details-panel3-lnk").closest("li").removeClass("hidden"),$("#details-panel3").removeClass("hidden")):($("#bp-content").html(""),$("#details-panel3-lnk").closest("li").addClass("hidden"),$("#details-panel3").addClass("hidden"),$("#details-panel3-lnk").parent().hasClass("active")&&($("#details-panel3-lnk").parent().removeClass("active"),$("#details-panel1-lnk").click()))}).catch(function(e){$("#bp-content").html(""),$("#details-panel3-lnk").parent().addClass("hidden"),$("#details-panel3-lnk").parent().hasClass("active")&&($("#details-panel3-lnk").parent().removeClass("active"),$("#details-panel1-lnk").click())})}),apiCallRead=(e,t,a,n)=>a.map(a=>{url="php/process-read.php",post={dates:e,url:t,oUrl:n,lang:document.documentElement.lang};let r=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(r).then(e=>e.json()).then(e=>{-1==e.html.indexOf("No data")?($("#read-content").html(e.html),$("#details-panel4-lnk").parent().removeClass("hidden")):($("#read-content").html(""),$("#details-panel4-lnk").parent().addClass("hidden"),$("#details-panel4-lnk").parent().hasClass("active")&&($("#details-panel4-lnk").parent().removeClass("active"),$("#details-panel3-lnk").click()))}).catch(function(e){$("#read-content").html(""),$("#details-panel4-lnk").parent().addClass("hidden"),$("#details-panel4-lnk").parent().hasClass("active")&&($("#details-panel4-lnk").parent().removeClass("active"),$("#details-panel3-lnk").click())})});function downloadPDF(){document.querySelector("#canvas-container");var e=new jsPDF("portrait");e.setFontSize(20),e.text(15,15,"Cool Chart"),e.addImage(canvasImg,"PNG",10,10,280,150),e.save("canvas.pdf")}$("#urlform").submit(function(e){e.preventDefault(),url=$("#urlval").val(),$("#urlStatic").html(url),start=$(".dr-date-start").html(),end=moment(),mainQueue(url,start,end,0)}),$("a#h2href").click(function(){event.preventDefault(),url=$("#urlStatic").html(),start=$(".dr-date-start").html(),end=moment(),1==$("#urlLang").html()?$("#urlLang").html(0):$("#urlLang").html(1),mainQueue(url,start,end,"1")}),$("#ddRange").submit(function(e){e.preventDefault(),url=$("#urlval").val(),$("#urlStatic").html(url),start=$(".dr-date-start").html(),end=moment(),mainQueue(url,start,end,0)});const removeQueryString=e=>{var t=document.createElement("a");return t.href=e,t.search="",$href=t.href,/Edge/.test(navigator.userAgent)&&($href=$href.substring(0,$href.length-1)),$href},containsAny=(e,t)=>{for(var a=0;a!=t.length;a++){var n=t[a];if(-1!=e.indexOf(n))return n}return null},mainQueue=(e,t,a,n)=>{if(console.log(e),$("#canvas-container").addClass("hidden"),$("#whole-canvas").addClass("hidden"),$("#notfound").addClass("hidden"),$("#error").addClass("hidden"),$("#loading").removeClass("hidden"),$success=0,console.log(e),"https://"==e.substring(0,8)&&containsAny(e,substrings)){if($isApp=/(apps[1-8].ams-sga.cra-arc.gc.ca)/.test(e)?1:0,console.log("isApp: "+$isApp),oUrl=e,e=e.substring(8,e.length),console.log(e),e=e.length>255?e.substring(e.length-255,e.length):e,moment.locale("en"),$dd=$("#date-range").find(":selected").data("index"),$.isNumeric($dd)||($dd=1),t&&a)vStart=t,r=a;else{t=moment();var r=moment().format("dddd MMMM DD, YYYY");0==$dd?vStart=moment(t).subtract(30,"days").format("dddd MMMM DD, YYYY"):1==$dd?vStart=moment(t).subtract(7,"days").format("dddd MMMM DD, YYYY"):2==$dd&&(vStart=moment(t).subtract(1,"days").format("dddd MMMM DD, YYYY"))}t=moment(vStart).format("YYYY-MM-DDTHH:mm:ss.SSS"),a=moment(r).format("YYYY-MM-DDTHH:mm:ss.SSS"),moment(r).subtract(1,"days").format("YYYY-MM-DDTHH:mm:ss.SSS");var s=[t,a];console.log(s);var l=moment(vStart),o=moment(r);l.locale(document.documentElement.lang),o.locale(document.documentElement.lang);var i=l.format("dddd MMMM DD, YYYY"),d=o.subtract(1,"days").format("dddd MMMM DD, YYYY");$("#fromdaterange").html("<strong>"+i+"</strong>"),$("#todaterange").html("<strong>"+d+"</strong>");t=moment(vStart),a=moment(r);dDay=a.diff(t,"days"),dWeek=a.diff(t,"week",!0),$("#numDays").html(dDay),$("#numWeeks").html(dWeek),$("#searchBttn").prop("disabled",!0);var c=["dbGet"];if(console.log("language: "+n),$isApp){var p=["trnd","prvs","metrics-new"];m=1==$("#urlLang").html()?"fr":"en",e=e.substring(5,e.length)}else{p=["trnd","prvs","srchAll","snmAll","srchLeftAll","activityMap","metrics-new","fwylf"];var m="bi"}var u=["cntry","qryAll","qryMobile","qryDesktop","qryTablet","totals","totalDate"];console.log("language abbr: "+m);const h=()=>($("#loadGSC").empty(),$("#loadAA").html($.i18n("FetchdataAA")),e=$("#urlStatic").html(),oUrl=$("#urlStatic").html(),Promise.all(apiCall2(s,e,c,oUrl,n))),g=()=>($("#loadAA").empty(),$("#loadFD").html($.i18n("FetchdataFD")),$isApp?(oUrl2=e.substring(13,e.length),e=e.substring(13,e.length)):(e=$("#urlStatic").html(),oUrl2=$("#urlStatic").html()),Promise.all(apiCall(s,e,p,oUrl2,$dd,"aa",m))),v=t=>(console.log("LOOOG "+t),$isApp?t:(e=$("#urlStatic").html(),oUrl=$("#urlStatic").html(),dd=[$("#fromGSC").text(),$("#toGSC").text()],Promise.all(apiCall(dd,e,u,oUrl,$dd,"gsc")),t)),f=e=>{console.log("-----------------------------"),console.log(e);var t=extractJSON(e,"");return console.log(t),$("#searchBttn").prop("disabled",!1),Promise.resolve(t)},b=e=>$isApp?Promise.resolve($.i18n("Page-levelstatistics")):Promise.all([getPageH1(e[0].url)]);(()=>$isApp?Promise.resolve("null"):($("#loadGSC").html($.i18n("FetchdataGSC")),Promise.all(apiCallGSC2(s,e,c,oUrl,dDay,n))))().then(e=>b(e)).then(e=>{$("#h2title").html(e)}).then(()=>h()).then(()=>g()).then(e=>f(e)).then(e=>v(e)).then(e=>{console.log("log: "+e),-1!==$("#urlStatic").html().indexOf("/fr/")&&!$isApp||1==$("#urlLang").html()&&$isApp?$("a#h2href").html($.i18n("LanguageToggleFR")):$("a#h2href").html($.i18n("LanguageToggleEN")),$isApp?($("#rap-container").addClass("hidden"),$("#snum-container").addClass("hidden"),$("#search-container").addClass("hidden"),$("#fwlf-container").addClass("hidden"),$("#srchA-container").addClass("hidden"),$("#np-container").addClass("hidden"),$("#details-panel2-lnk").closest("li").addClass("hidden"),$("#details-panel2").addClass("hidden")):($("#rap-container").removeClass("hidden"),$("#snum-container").removeClass("hidden"),$("#search-container").removeClass("hidden"),$("#fwlf-container").removeClass("hidden"),$("#srchA-container").removeClass("hidden"),$("#np-container").removeClass("hidden"),$("#details-panel2-lnk").closest("li").removeClass("hidden"),$("#details-panel2").removeClass("hidden")),e?($("#loading").addClass("hidden"),$("#loadFD").empty(),$("#notfound").addClass("hidden"),$("#error").removeClass("hidden"),$("#errorHeader").val($("#urlStatic").text()),$("#searchBttn").prop("disabled",!1),$("#urlval").val($("#urlStatic").text()),date=$("#date-range").val(),$("#loadComp").html($.i18n("FetchdataComplete")),setQueryParams(oUrl,date),$("#loadComp").empty()):($("#loading").addClass("hidden"),$("#loadFD").empty(),$("#error").addClass("hidden"),$("#notfound").addClass("hidden"),$("#whole-canvas").removeClass("hidden"),$("#searchBttn").prop("disabled",!1),$("#urlval").val($("#urlStatic").text()),date=$("#date-range").val(),$("#loadComp").html($.i18n("FetchdataComplete")),setQueryParams(oUrl,date),$("#loadComp").empty(),$("#canvas-container").removeClass("hidden")),0==$dd?($("#gscDate").html($.i18n("Last30days")),$("#ddDate").html($.i18n("Last30days"))):1==$dd?($("#gscDate").html($.i18n("Last7days")),$("#ddDate").html($.i18n("Last7days"))):2==$dd&&($("#gscDate").html($.i18n("Yesterday")),$("#ddDate").html($.i18n("Yesterday"))),2===$dd?($("#todaterange").addClass("hidden"),$("#to").addClass("hidden"),$("#todaterangegsc").addClass("hidden"),$("#gscto").addClass("hidden")):($("#todaterange").removeClass("hidden"),$("#to").removeClass("hidden"),$("#todaterangegsc").removeClass("hidden"),$("#gscto").removeClass("hidden"))}).catch(console.error.bind(console)),$success=1}$success||($("#loading").addClass("hidden"),$("#notfound").removeClass("hidden"))};